<!DOCTYPE>
<html>
    <head>
		<script src="../API/jquery.js"></script>
		<script src="../API/335bootstrap.js"></script>
		<link rel="stylesheet" href="../API/335bootstrap.css">
		<link href="../images/icons/mobile_navigation/1logo.png" rel="shortcut icon">
		<title>laisa</title>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
        <link href='../css/index.css' rel='stylesheet' type="text/css">
        <link href='../css/signin.css' rel='stylesheet' type="text/css">
        <link href='../css/profile.css' rel='stylesheet' type="text/css">
        <!--<script src="http://malsup.github.com/jquery.form.js"></script>-->
    </head>
        
    <body id="dabody">
                
		<!--Mobile Navigation bar-->
		<div class="mobile_nav_head" id="nav_head">
			<div class="container-fluid">
				<a href="javascript:open_profile_menu();">
					<img id="profile_menu" src="../images/icons/mobile_navigation/profile_menu.png">
				</a>
				<a href="javascript:close_profile_menu();">
					<img id="close_menu1" src="../images/icons/mobile_navigation/close_menu.png">
				</a>	    
					
				<a href="javascript:profile()">
					<img id="mobile_logo" src="../images/icons/mobile_navigation/logo.png" />
				</a>
                	   
				<a href="javascript:open_search_menu();">
					<img id="search_menu" src="../images/icons/mobile_navigation/search_menu.png">
				</a>	
				<a href="javascript:close_search_menu();">	
					<img id="close_menu2" src="../images/icons/mobile_navigation/close_menu.png">
				</a>
			</div>
		</div>                
                
		<!--Profile Menu-->
		<div id="profile_menu_button">
			<div class="container-fluid">
              
				<ul id="profile_menu_ul">
					<li class="profile_menu_li">
						<a href="javascript:add_post()" style="text-decoration:none">
							<img id="profile_menu_li_img" src="../images/icons/profile_menu/add_post.png"/>
							<span id="profile_menu_li_head">Add Post</span>
						</a>
					</li>
					
                   
					<li class="profile_menu_li">
						<a href="javascript:inbox()" style="text-decoration:none;">
							<img id="profile_menu_li_img" src="../images/icons/profile_menu/inbox.png"/>
							<span id="profile_menu_li_head">Inbox</span>
						</a>
					</li>
					
					
					<li class="profile_menu_li">
						<a href="javascript:wishlist()" style="text-decoration:none;">
							<img id="profile_menu_li_img" src="../images/icons/profile_menu/wishlist.png"/>
							<span id="profile_menu_li_head">Wish List</span>
						</a>
                    </li>
					
				</ul>
                     
				<!--
				<div id="logout_div">
					<a href="http://www.sqaaps.co.za/php/laisa/signout.php">
						<span id="logout_span">Logout</span>
					</a>
				</div>
				-->
			</div>
		</div>                
                
		<!--Search Menu-->
		<div id="search_menu_button">
			<div class="container-fluid" id="search_menu_container">
						
				<h4 id="search_menu_header">Search Travel Plans</h4>
						
				<form id="mobile_search_menu_form" name="mobile_search_menu_form"Â action="" method="POST">

					<!-- Departure Field -->
					<input id="search_menu_departure" name="departure" type="text" placeholder=" Departure" required />                            

					<!-- Destination Field -->
					<input id="search_menu_destination" name="destination" type="text" placeholder=" Destination" />
					
					<!-- D A T E -->
					<input id="search_menu_date" name="date" type="date" placeholder=" DATE: YYYY/MM/DD" />
					

					<br>
					<input id="search_menu_offering_transport" type="radio" name="type" value="o" checked/>
					<span id="span_search_menu_offering_looking"> I'm looking for Transport</span>
							
					<br>
					<input id="search_menu_offering_passenger" type="radio" name="type" value="w" />
					<span id="span_search_menu_offering_looking"> I'm looking for Passengers</span>

					<p id="validate_status"></p>

					<!-- Form submit button -->
					<button type="button" id="search_menu_search" name="search_menu_search" onclick="search()" >SEARCH</button>
				</form>

			</div>
		</div>
		
		
		<!--P R O F I L E-->
		<div id="profile_head"></div>
        
		
		<div id="send_msg_container"></div>
		
		<!--Wishlist div-->
		<div class="wishlist_body_cover" id="wishlist_body_cover">
			<div class="wishlist_div">
				<h3 class="wishlist_div_head">Wishlist</h3>
				<p class="wishlist_div_p">Added to Wishlist</p>
			</div>
		</div>
		
		<div class="wishlist_body_cover" id="message_body_cover">
			<div class="wishlist_div">
				<h3 class="wishlist_div_head">Message</h3>
				<p class="wishlist_div_p">Message Sent</p>
			</div>
		</div>
		
		
		<!--J A V A S C R I P T-->
		<script src="../js/index.js"></script>
        <script type="text/javascript">
			function profile_fn(){
				var page_url = window.location.href;
				var page_url_split = page_url.split("?");
				var id = page_url_split[1];
				
				var ajax = ajaxObj("POST", "http://www.sqaaps.co.za/php/laisa/profile.php");
				//var ajax = ajaxObj("POST", "../php/profile.php");
				
				ajax.onreadystatechange = function() {
					if(ajaxReturn(ajax) == true) {
						_("profile_head").innerHTML = ajax.responseText;
					}
				}
				ajax.send("profile=" + id + "&session_user=" + localStorage.getItem("id"));
			}
			window.onload = profile_fn;
			
			function add_post(){
				window.location.assign("./post.html?" + localStorage.getItem("id"));
			}
			
			function wishlist(){
				window.location.assign("./wishlist.html?" + localStorage.getItem("id"));
			}
			function add_to_wishlist(id){
				var ajax = ajaxObj("POST", "http://www.sqaaps.co.za/php/laisa/profile.php");
				//var ajax = ajaxObj("POST", "../php/profile.php");
				
				ajax.onreadystatechange = function() {
					if(ajaxReturn(ajax) == true) {
						if(ajax.responseText.slice(-8) === 'wishlist'){
							_("wishlist_body_cover").style.display = "block";
							$("#wishlist_body_cover").fadeOut(4000);
						}
					}
				}
				ajax.send("addtowishlist=" + id + "&session_user=" + localStorage.getItem("id"));
			}
			
			function inbox(){
				window.location.assign("./inbox.html?" + localStorage.getItem("id"));
			}
			
			function profile(){
				window.location.assign("./profile.html?" + localStorage.getItem("id"));
			}
			
			function delete_post(ad_id){
				var ajax = ajaxObj("POST", "http://www.sqaaps.co.za/php/laisa/profile.php");
				ajax.onreadystatechange = function() {
					if(ajaxReturn(ajax) == true) {
						if(ajax.responseText.slice(-7) === 'deleted'){
							window.location.assign("./profile.html?" + localStorage.getItem("id"));
						}
					}
				}
				ajax.send('delete=' + ad_id + '&user_id='+ localStorage.getItem("id"));
			}
			
			function search(){
				_("search_menu_button").style.display = "none";
				_("close_menu2").style.display = "none";
				
				_("search_menu").style.display = "block";
				_("profile_menu").style.display = "block";
				
				var departure = _("search_menu_departure").value;
				var destination = _("search_menu_destination").value;
				var date = _("search_menu_date").value;
								
				if(_("search_menu_offering_transport").checked){
					var type = "o";
				} else{
					var type = "w";
				}
				
				var status = _("validate_status");
				
				if(departure == "" || destination == "" || date == ""){
					status.innerHTML = '<span style="color: #ff0000;font-family: sans-serif;margin-left: 15px;font-size: 15px;">Fill out all of the form data</span>';
				} else {			
					status.innerHTML = 'please wait ...';
					var ajax = ajaxObj("POST", "http://www.sqaaps.co.za/php/laisa/search.php");
					//var ajax = ajaxObj("POST", "../php/search.php");
					ajax.onreadystatechange = function() {
						if(ajaxReturn(ajax) == true) {
							_("search_results").innerHTML = ajax.responseText;
							_("view_all_ads").style.display = "none"
							status.innerHTML = '';
						}
					}
					ajax.send("departure="+departure+"&destination="+destination+"&date="+date+"&type="+type+"&html="+'');
				}
			}
			
			function submitForm() {
				var fullName = _("name_input").value;
				var email = _("email_input").value;
				var message = _("message_input").value;

				if(fullName == "" || email == "" || message == ""){
					if(fullName == ""){
						_("name_input").style.border = "2px solid red";
					}else{
						_("name_input").style.border = "1px solid gainsboro";
					}
					
					if(email == ""){
						_("email_input").style.border = "2px solid red";
					} else{
						_("email_input").style.border = "1px solid gainsboro";
					}
					
					if(message == ""){
						_("message_input").style.border = "2px solid red";
					}else{
						_("message_input").style.border = "1px solid gainsboro";
					}
				}else{
					_("submit_contact_us_form").disabled = true;
					_("submit_contact_us_form").innerHTML = 'please wait ...';
					
					//var ajax = ajaxObj("POST", "http://www.sqaaps.co.za/php/laisa/signin.php/send_email.php" );
					var ajax = ajaxObj("POST", "../php/send_email.php");
					ajax.onreadystatechange = function() {
						if(ajax.readyState === 4 && ajax.status === 200) {
							if(ajax.responseText === "success"){
								alert('Message Sent');
								$('#contact_us_form').slideUp("fast", "linear");
							} else {
								alert('Message Failed To Send. Try again later.');
							}
							_("submit_contact_us_form").disabled = false;
							_("submit_contact_us_form").innerHTML = 'Submit';
						}
					}
					ajax.send("email=" + "" + "&fullName=" + fullName + "&email=" + email + "&message=" + message);
				}
			}
			
			function show_contact(){
				$('div#contact_us_form').toggle();
				$('html,body').animate({scrollTop: $("div#contact_us_form").offset().top}, 'slow');
			}
		</script>
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBUwakWff-5NOHsFTlxgWr4uSWb9Syjroo&libraries=places&callback=initAutocomplete"
        async defer></script>
		<script>
			// This example displays an address form, using the autocomplete feature
            // of the Google Places API to help users fill in the information.
            
            // This example requires the Places library. Include the libraries=places
            // parameter when you first load the API. For example:
            // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

            var placeSearch, search_menu_departure, search_menu_destination;
			
            var componentForm = {
                street_number: 'short_name',
                route: 'long_name',
                locality: 'long_name',
                administrative_area_level_1: 'short_name',
                country: 'long_name',
                postal_code: 'short_name'
            };

            function initAutocomplete() {

                search_menu_departure = new google.maps.places.Autocomplete((document.getElementById('search_menu_departure')),
                    {types: ['geocode']});

                // When the user selects an address from the dropdown, populate the address
                // fields in the form.
                search_menu_departure.addListener('place_changed', function() {
                    fillInAddress(search_menu_departure, "");
                });
          
                search_menu_destination = new google.maps.places.Autocomplete(
                    /** @type {!HTMLInputElement} */(document.getElementById('search_menu_destination')),
                    {types: ['geocode']});

                // When the user selects an address from the dropdown, populate the address
                // fields in the form.
                search_menu_destination.addListener('place_changed', function() {
                    fillInAddress(search_menu_destination, "2");
                });
            }

            function fillInAddress(autocomplete, unique) {
                // Get the place details from the autocomplete object.
                var place = autocomplete.getPlace();

                for (var component in componentForm) {
                    if (!!document.getElementById(component + unique)) {
                        document.getElementById(component + unique).value = '';
                        document.getElementById(component + unique).disabled = false;
                    }
                }

                // Get each component of the address from the place details
                // and fill the corresponding field on the form.
                for (var i = 0; i < place.address_components.length; i++) {
                    var addressType = place.address_components[i].types[0];
                    if (componentForm[addressType] && document.getElementById(addressType + unique)) {
                        var val = place.address_components[i][componentForm[addressType]];
                        document.getElementById(addressType + unique).value = val;
                    }
                }
            }
            
            google.maps.event.addDomListener(window, "load", initAutocomplete);
            
            // Bias the autocomplete object to the user's geographical location,
            // as supplied by the browser's 'navigator.geolocation' object.
            function geolocate() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        var geolocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        var circle = new google.maps.Circle({
                            center: geolocation,
                            radius: position.coords.accuracy
                        });
                        autocomplete.setBounds(circle.getBounds());
                    });
                }
            }
		</script>
    </body>
</html>